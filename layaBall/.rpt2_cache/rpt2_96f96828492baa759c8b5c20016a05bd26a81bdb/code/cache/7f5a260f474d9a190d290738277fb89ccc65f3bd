{
  "code": "var State = {\r\n    Idle: 1,\r\n    AddForce: 2,\r\n    ThrowOut: 3,\r\n    CheckOut: 4,\r\n};\r\nexport default class ball_ctrl extends Laya.Script3D {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = State.Idle;\r\n        this.body = null;\r\n        this.MIN_SPEED = 0;\r\n        this.MAX_SPEED = 0;\r\n        this.add_force = 0;\r\n        this.groud_speed = 0;\r\n    }\r\n    reset() {\r\n        this.state = State.Idle;\r\n        this.body.overrideGravity = true;\r\n        this.body.gravity = new Laya.Vector3(0, 0, 0);\r\n    }\r\n    onAwake() {\r\n        this.MIN_SPEED = 4.5;\r\n        this.MAX_SPEED = 7;\r\n        this.groud_speed = (this.MAX_SPEED - this.MIN_SPEED) / 3;\r\n        this.body = this.owner.getComponent(Laya.Rigidbody3D);\r\n        Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.on_touch_start);\r\n        Laya.stage.on(Laya.Event.MOUSE_UP, this, this.on_touch_end);\r\n        this.reset();\r\n    }\r\n    on_touch_start() {\r\n        if (this.state !== State.Idle) {\r\n            return;\r\n        }\r\n        this.state = State.AddForce;\r\n        this.add_force = 0;\r\n    }\r\n    throw_ball() {\r\n        this.body.overrideGravity = true;\r\n        this.body.gravity = new Laya.Vector3(0, -10, 0);\r\n        var speed = 4.5 + this.add_force;\r\n        var degree = 60;\r\n        var r = degree * Math.PI / 180;\r\n        var vy = speed * Math.sin(r);\r\n        var vz = speed * Math.cos(r);\r\n        this.body.linearVelocity = new Laya.Vector3(0, vy, vz);\r\n    }\r\n    on_touch_end() {\r\n        if (this.state !== State.AddForce) {\r\n            return;\r\n        }\r\n        this.state = State.ThrowOut;\r\n        this.throw_ball();\r\n    }\r\n    onUpdate() {\r\n        if (this.state === State.AddForce) {\r\n            var dt = Laya.timer.delta / 1000;\r\n            this.add_force += (this.groud_speed * dt);\r\n            this.add_force = (this.add_force > (this.MAX_SPEED - this.MIN_SPEED)) ? (this.MAX_SPEED - this.MIN_SPEED) : this.add_force;\r\n        }\r\n    }\r\n    onTriggerEnter(other) {\r\n        Laya.stage.event(\"WIN_SOCRE\", null);\r\n    }\r\n}\r\n",
  "references": []
}
